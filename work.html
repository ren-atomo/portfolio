<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>作品詳細 - 堤廉太郎</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <!-- Navigation -->
    <nav class="nav">
        <div class="nav-inner">
            <a href="index.html" class="nav-logo">堤廉太郎</a>
            <ul class="nav-menu">
                <li><a href="index.html">Works</a></li>
                <li><a href="statement.html">Statement</a></li>
                <li><a href="about.html">About</a></li>
            </ul>
        </div>
    </nav>

    <!-- Work Detail -->
    <main class="work-detail">
        <div class="work-detail-container">
            <!-- 作品の大きな画像/動画 -->
            <div class="work-media" id="workMedia">
                <!-- JavaScriptで生成 -->
            </div>

            <!-- 作品情報 -->
            <div class="work-info">
                <div class="work-header">
                    <h1 class="work-title" id="workTitle"></h1>
                    <p class="work-meta">
                        <span class="work-category" id="workCategory"></span>
                        <span class="work-tech" id="workTech"></span>
                    </p>
                </div>

                <div class="work-description" id="workDescription"></div>

                <!-- 背景にある思想 -->
                <div class="work-philosophy">
                    <h2 class="philosophy-title">この作品の背景にある思想</h2>
                    <h3 class="philosophy-subtitle" id="philosophySubtitle"></h3>
                    <p class="philosophy-detail" id="philosophyDetail"></p>
                    <a href="statement.html" class="philosophy-link">思想について詳しく →</a>
                </div>

                <!-- テーマタグ -->
                <div class="work-themes" id="workThemes"></div>
            </div>
        </div>

        <!-- 前後の作品へのナビゲーション -->
        <nav class="work-nav">
            <a href="#" class="work-nav-prev" id="prevWork">← 前の作品</a>
            <a href="index.html" class="work-nav-grid">作品一覧</a>
            <a href="#" class="work-nav-next" id="nextWork">次の作品 →</a>
        </nav>
    </main>

    <script src="js/works-data.js"></script>
    <script src="js/main.js"></script>
    <script>
        // URLパラメータから作品IDを取得
        const urlParams = new URLSearchParams(window.location.search);
        const workId = urlParams.get('id');
        const work = getWorkById(workId);

        if (work) {
            // タイトル更新
            document.title = `${work.title} - 堤廉太郎`;

            // メディア表示
            const workMedia = document.getElementById('workMedia');
            if (work.video) {
                // YouTube動画の場合
                workMedia.innerHTML = `
                    <iframe 
                        src="${work.video}" 
                        frameborder="0" 
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                        allowfullscreen>
                    </iframe>
                `;
            } else {
                // 画像の場合
                workMedia.innerHTML = `
                    <img src="${work.image}" alt="${work.title}">
                    ${work.videoPlaceholder ? '<div class="video-coming-soon">Video coming soon</div>' : ''}
                `;
            }

            // 作品情報
            document.getElementById('workTitle').textContent = work.title;
            document.getElementById('workCategory').textContent = work.category;
            if (work.tech) {
                document.getElementById('workTech').textContent = work.tech;
            }
            document.getElementById('workDescription').textContent = work.description;

            // 思想
            document.getElementById('philosophySubtitle').textContent = work.philosophy;
            document.getElementById('philosophyDetail').textContent = work.philosophyDetail;

            // テーマタグ
            const themesContainer = document.getElementById('workThemes');
            work.themes.forEach(theme => {
                const tag = document.createElement('span');
                tag.className = 'theme-tag';
                tag.textContent = theme;
                themesContainer.appendChild(tag);
            });

            // 前後の作品ナビゲーション
            const allWorks = getAllWorks();
            const currentIndex = allWorks.findIndex(w => w.id === workId);
            
            const prevWork = document.getElementById('prevWork');
            const nextWork = document.getElementById('nextWork');

            if (currentIndex > 0) {
                prevWork.href = `work.html?id=${allWorks[currentIndex - 1].id}`;
                prevWork.style.display = 'block';
            } else {
                prevWork.style.display = 'none';
            }

            if (currentIndex < allWorks.length - 1) {
                nextWork.href = `work.html?id=${allWorks[currentIndex + 1].id}`;
                nextWork.style.display = 'block';
            } else {
                nextWork.style.display = 'none';
            }
        } else {
            // 作品が見つからない場合
            document.querySelector('.work-detail-container').innerHTML = `
                <div class="error-message">
                    <h1>作品が見つかりません</h1>
                    <a href="index.html">作品一覧に戻る</a>
                </div>
            `;
        }
    </script>
</body>
</html>
